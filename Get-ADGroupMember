########## This Powershell script shows all members of an Active-Directory Group ###########
# Created on : August 23, 2019
# Last modification : August 23, 2019
# Script revision : 1.0


# Defining a mandatory parameter which asks for the Active-Directory Group.

Param(
    [Parameter(Mandatory=$true)]
    [string] $Group = $(Read-Host -prompt "Group : "),
)


# Allowing the script to be executed and importing Active-Directory module in Powershell.

Set-ExecutionPolicy Unrestricted
Import-Module ActiveDirectory


# Getting current datetime (i.e. : 31/07/2019 - 12:08).

$Date = Get-Date -Format "dd/MM/yyyy - HH:mm"


#Creating an exception catcher to save exceptions into a log file and then end the script.

$Error = {
    $Exception = $error[0].$Exception.GetType().fullname
    Write-Warning $_
    "$Date : Failed to show all members belonging to $Group : $_"|Add-Content C:\Users\$env:USERNAME\Documents\logs_2.txt
    exit(1)
}


# Trying to show all members of the Active-Directory group. If an exception occurred, it is catched by the exception catcher written above.

try {
    Get-ADGroupMember -Identity $Group
}
catch {
    .$Error
}

# End of the script if no exception has occurred.

exit(0)
