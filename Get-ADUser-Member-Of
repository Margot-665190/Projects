##########Â This Powershell script shows all groups of an Active-Directory Member ###########
# Created on : July 31, 2019
# Last modification : July 31, 2019
# Script revision : 1.0


# Defining a mandatory parameter which asks for the Active-Directory member's username.

Param(
    [Parameter(Mandatory=$true)]
    [string] $Username = $(Read-Host -prompt "Username (e.g. : F.Lastname) : ")
)


# Allowing the script to be executed and importing Active-Directory module in Powershell.

Set-ExecutionPolicy Unrestricted
Import-Module ActiveDirectory


# Getting current datetime (i.e. : 31/07/2019 - 12:08).

$Date = Get-Date -Format "dd/MM/yyyy - HH:mm"


#Creating an exception catcher to save exceptions into a log file and then end the script.

$Error = {
    $Exception = $error[0].$Exception.GetType().fullname
    Write-Warning $_
    "$Date : Failed to show all groups $Username belongs to : $_"|Add-Content C:\Users\$env:USERNAME\Documents\logs_1.txt
    exit(1)
}


# Trying to show all groups of the Active-Directory member. If an exception occurred, it is catched by the exception catcher written above.

try {
    (Get-ADUser $Username -Properties MemberOf | Select-Object MemberOf).MemberOf
}
catch {
    .$Error
}


# End of the script if no exception has occurred.

exit(0)
